#include <Arduino.h>
#include <Wire.h>
#include <TinyGPSplusplus.h>  //gps lib
#include <ReceiveOnlySoftwareSerial.h>
#include <INA219.h>
#include <EEPROM.h> 
#include <CN0349.h>
#include <avr/io.h> 
#include <avr/sleep.h>
#include <avr/wdt.h>
#include <avr/power.h>
#include <usart.h>

UsartDescriptor usart0 = {
	.ubrrh = &UBRR0H,
	.ubrrl = &UBRR0L,
	.ucsra = &UCSR0A,
	.ucsrb = &UCSR0B,
	.ucsrc = &UCSR0C,
	.udr = &UDR0,
	.ddr_xck = &DDRB,

	.u2x = U2X0,
	.rxen = RXEN0,
	.txen = TXEN0,
	.udre = UDRE0,
	.rxc = RXC0,
	.umsel1 = UMSEL01,
	.umsel0 = UMSEL00,
	.upm1 = UPM01,
	.upm0 = UPM00,
	.usbs = USBS1,
	.ucsz2 = UCSZ02,
	.ucsz1 = UCSZ01,
	.ucsz0 = UCSZ00,
	.ucpol = UCPOL0,
	.xck = PB0
};

void startup(void){
  init();
  pinMode(22, OUTPUT); 
  digitalWrite(22,HIGH); //LED on
  pinMode(8, OUTPUT); 
  digitalWrite(8,HIGH); //Sensors on
 
}
	
int main(void){  
    startup(); // place after sleep ends
	usart_set_baud(&usart0, USART_BAUD_RATE_9600);
		usart_enable_writing(&usart0);
	for(;;){
		
		usart_write(&usart0, 'H');
		usart_write(&usart0, 'e');
		usart_write(&usart0, 'l');
		usart_write(&usart0, 'l');
		usart_write(&usart0, 'o');
		usart_write(&usart0, ' ');
		usart_write(&usart0, 'W');
		usart_write(&usart0, 'o');
		usart_write(&usart0, 'r');
		usart_write(&usart0, 'l');
		usart_write(&usart0, 'd');
		usart_write(&usart0, '!');
		delay(1000);
	}
}



