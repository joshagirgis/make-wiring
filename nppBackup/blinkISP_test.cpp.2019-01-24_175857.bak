#include <Arduino.h>
#include <Wire.h>
#include <TinyGPSplusplus.h>  //gps lib
#include <ReceiveOnlySoftwareSerial.h>
#include <INA219.h>
#include <EEPROM.h> 
#include <CN0349.h>
#include <avr/io.h> 
#include <avr/sleep.h>
#include <avr/wdt.h>
#include <avr/power.h>


void startup(void){
  init();
  pinMode(22, OUTPUT); 
  digitalWrite(22,HIGH); //LED on
  pinMode(8, OUTPUT); 
  digitalWrite(8,HIGH); //Sensors on
 
}
	
void USART_Init(){

    // Set baud rate
    UBRR0H = 0x00; // Based CodeVision Source  
    UBRR0L = 0x5F; // U2X0 = 1 -> Datasheet   
    atmega644P(fosc=7.3728 MHz) -> UBRR = 95(10)
    = 0x5F(16)
    UCSR0A = (1<<U2X0);
    // Enable receiver and transmitter 
    UCSR0B = (1<<UDRIE0)|(1<<UCSZ02)|(1<<RXEN0)|
    (1<<TXEN0);
    // Set Frame Format
    // >> asynchronous mode
    // >> no parity (none)
    // >> 1 stopbit
    // >> char size 8
    UCSR0C = (0<<UMSEL01)|(0<<UMSEL00)|(0<<UPM01)|
    (0<<UPM00)|(0<<USBS0)|(0<<UCSZ02)|(1<<UCSZ01)|
    (1<<UCSZ00); 

}

unsigned char USART_Receive(void){

	// Wait for data to be received
	while(!(UCSR0A&(1<<RXC0)));
	// Get and return received data from buffer
	return UDR0;

}

void USART_Transmit(unsigned char data){

	// Wait for empty transmit buffer
	while (!(UCSR0A&(1<<UDRE0)));
	// Put data into buffer, sends the data
	UDR0 = data;

}

void USART_Flush(void){

	unsigned char dummy;

	while(UCSR0A&(1<<RXC0)) 
		dummy = UDR0;

}

int main(){

	unsigned char data;

	USART_Init();

	while(1){

		data='A';

		USART_Transmit(data);

	}

	return(0);

}